<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>📘 Probabilistic Graphical Models</title>
  <style>
    :root {
      --bg: #fafafa;
      --fg: #222;
      --border: #ddd;
      --accent: #0066cc;
    }

    body.dark {
      --bg: #121212;
      --fg: #f1f1f1;
      --border: #333;
      --accent: #4ea1ff;
    }

    body {
      margin: 0;
      font-family: sans-serif;
      background: var(--bg);
      color: var(--fg);
      padding: 50px;
      transition: background 0.3s, color 0.3s;
    }

    h1 {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 1.6em;
      margin-bottom: 20px;
    }

    button {
      background: var(--accent);
      color: white;
      border: none;
      border-radius: 6px;
      padding: 6px 10px;
      cursor: pointer;
    }

    button:hover { opacity: 0.9; }

    ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    li {
      font-size: 1.1em;
      margin: 10px 0;
      cursor: pointer;
      transition: color 0.2s;
    }

    li::before {
      content: "📂 ";
    }

    li:hover {
      color: var(--accent);
    }

    #message {
      font-style: italic;
      color: #777;
      margin-top: 30px;
    }
  </style>
</head>
<body>
  <h1>
    📘 Probabilistic Graphical Models
    <button id="themeToggle">🌙</button>
  </h1>
  <ul id="chapter-list"></ul>
  <p id="message"></p>

  <script>
    // 🌙 다크모드
    const btn = document.getElementById('themeToggle');
    btn.addEventListener('click', () => {
      document.body.classList.toggle('dark');
      btn.textContent = document.body.classList.contains('dark') ? '☀️' : '🌙';
    });

    // 📂 structure.json 로드
    fetch('../structure.json')
      .then(response => response.json())
      .then(data => {
        const list = document.getElementById('chapter-list');
        const msg = document.getElementById('message');
        const topLevel = data[0].contents || data;

        // probabilistic_graphical_models 폴더만 찾기
        const pgmFolder = findFolder(topLevel, 'probabilistic_graphical_models');
        if (!pgmFolder) {
          msg.textContent = "⚠️ 'probabilistic_graphical_models' 폴더를 찾을 수 없습니다.";
          return;
        }

        const chapters = pgmFolder.contents.filter(item => item.type === 'directory');
        if (chapters.length === 0) {
          msg.textContent = "아직 chapter 폴더가 없습니다.";
        }

        // chapter 리스트 만들기
        chapters.forEach(ch => {
          const li = document.createElement('li');
          li.textContent = ch.name;
          li.addEventListener('click', () => {
            window.location.href = `${ch.name}/index.html`;
          });
          list.appendChild(li);
        });
      });

    // 🔍 특정 폴더 찾기 함수
    function findFolder(contents, name) {
      for (const item of contents) {
        if (item.type === 'directory' && item.name === name) return item;
        if (item.contents) {
          const found = findFolder(item.contents, name);
          if (found) return found;
        }
      }
      return null;
    }
  </script>
</body>
</html>
